


<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <title>Imperative MPC: An End-to-End Self-Supervised Learning with Differentiable MPC for UAV Attitude Control - ARI Lab</title>
    
    <link rel="stylesheet" href="/assets/css/app.css">

    <link rel="shortcut icon" type="image/ico" href="/img/favicon/favicon.ico" />

    <link rel="apple-touch-icon" sizes="180x180" href="/img/favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/img/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/img/favicon/favicon-16x16.png">
    <link rel="manifest" href="/img/favicon/site.webmanifest">
    <link rel="mask-icon" href="/img/favicon/safari-pinned-tab.svg" color="#0F173D">
    <meta name="msapplication-TileColor" content="#b91d47">
    <meta name="theme-color" content="#ffffff">

    <script defer src="https://use.fontawesome.com/releases/v5.3.1/js/all.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  
  <!-- Include the standard DataTables bits -->
  <link rel="stylesheet" type="text/css" href="//cdn.datatables.net/1.10.13/css/jquery.dataTables.css">
  <script type="text/javascript" charset="utf8" src="//cdn.datatables.net/1.10.13/js/jquery.dataTables.js"></script>
  <script>
    $(document).ready(function () {
      $('div.datatable-begin').nextUntil('div.datatable-end', 'table').addClass('display');
      $('table.display').DataTable({
        paging: false,
        stateSave: true,
        searching: true
      });
    });
  </script>
  
  
    <script>
      $(document).ready(function () {
          $('.content a').attr({'target':'_blank', 'rel':'noopener noreferrer'});
        });
    </script>
  

    <!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Imperative MPC: An End-to-End Self-Supervised Learning with Differentiable MPC for UAV Attitude Control | ARI Lab</title>
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="Imperative MPC: An End-to-End Self-Supervised Learning with Differentiable MPC for UAV Attitude Control" />
<meta name="author" content="Yuanzhu Zhan" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Advancing aerial autonomy" />
<meta property="og:description" content="Advancing aerial autonomy" />
<link rel="canonical" href="https://ari-psu.github.io/iMPC/" />
<meta property="og:url" content="https://ari-psu.github.io/iMPC/" />
<meta property="og:site_name" content="ARI Lab" />
<meta property="og:image" content="https://ari-psu.github.io/img/posts/2025-04-11-iMPC/Pipeline.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-04-11T12:00:00+00:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="https://ari-psu.github.io/img/posts/2025-04-11-iMPC/Pipeline.png" />
<meta property="twitter:title" content="Imperative MPC: An End-to-End Self-Supervised Learning with Differentiable MPC for UAV Attitude Control" />
<script type="application/ld+json">
{"mainEntityOfPage":{"@type":"WebPage","@id":"https://ari-psu.github.io/iMPC/"},"author":{"@type":"Person","name":"Yuanzhu Zhan"},"description":"Advancing aerial autonomy","url":"https://ari-psu.github.io/iMPC/","@type":"BlogPosting","image":"https://ari-psu.github.io/img/posts/2025-04-11-iMPC/Pipeline.png","headline":"Imperative MPC: An End-to-End Self-Supervised Learning with Differentiable MPC for UAV Attitude Control","dateModified":"2025-04-11T12:00:00+00:00","datePublished":"2025-04-11T12:00:00+00:00","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<!-- head scripts --><!-- Added by Chen -->
    <script type='text/javascript' src='https://platform-api.sharethis.com/js/sharethis.js#property=5ee902d30e78e50012567eb4&product=inline-follow-buttons&cms=sop' async='async'></script>

    <!-- for mathjax support -->
    

</head>

<body>
    
<nav class="navbar is-primary" >
    <div class="container">
        <div class="navbar-brand">
            <a href="/" class="navbar-item navbar-logo">
                ARI Lab
            </a>
            <a role="button" class="navbar-burger burger" aria-label="menu" aria-expanded="false" data-target="navMenu">
                <span aria-hidden="true"></span>
                <span aria-hidden="true"></span>
                <span aria-hidden="true"></span>
            </a>
        </div>
        <div class="navbar-menu" id="navMenu">
            <div class="navbar-start">
                <a href="/" class="navbar-item ">Home</a>
                
                
                    
                    <div class="navbar-item has-dropdown is-hoverable">
                        <a href="/current-members/" class="navbar-link ">Team</a>
                        <div class="navbar-dropdown">
                            
                            <a href="/current-members/" class="navbar-item ">Current Members</a>
                            
                            <a href="/alumni/" class="navbar-item ">Alumni</a>
                            
                        </div>
                    </div>
                    
                
                    
                    <a href="/research/" class="navbar-item ">Research</a>
                    
                
                    
                    <a href="/publications/" class="navbar-item ">Publications</a>
                    
                
                    
                    <a href="/news/" class="navbar-item ">News</a>
                    
                
                    
                    <a href="/contact/" class="navbar-item ">Contact</a>
                    
                
                
            </div>
        </div>
    </div>
</nav>
  <section class="hero  is-medium  is-bold is-primary" >
    <div class="hero-body">
        <div class="container">
            
                <p class="title is-2">Imperative MPC: An End-to-End Self-Supervised Learning with Differentiable MPC for UAV Attitude Control</p>
                <p class="subtitle is-3"></p>
                <p class="subtitle is-3">
            
            
            
        </p>
        </div>
    </div>
</section>

<style>
    .button.is-info {
     background-color:#0F173D;
     border-color:transparent;
     color:#fff
    }
    .button.is-info.is-hovered {
     background-color:#0F173D;
     border-color:transparent;
     color:#fff
    }
</style>
  


    <section class="section">
        <div class="container">
            <div class="columns">
                

                
                <div class="column is-8">
                      
	


<!-- Figure out the relative link to the author -->






<div class="content">

    <p><div style="font-size: 13px">Published: 
		<time datetime="2025-04-11T12:00:00+00:00">Apr 11, 2025</time> by 
		<div style="font-weight: bold; color: #3399ff; display: inline">
		
			Yuanzhu Zhan
		
		</div>
	</div></p>

    <h1>Imperative MPC: An End-to-End Self-Supervised Learning with Differentiable MPC for UAV Attitude Control</h1>

    <p>Modeling and control of nonlinear dynamics are critical in robotics, especially in scenarios with unpredictable external influences and complex dynamics. Traditional cascaded modular control pipelines often yield suboptimal performance due to conservative assumptions and tedious parameter tuning. Pure data-driven approaches promise robust performance but suffer from low sample efficiency, sim-to-real gaps, and reliance on extensive datasets. Hybrid methods combining learning-based and traditional model-based control in an end-to-end manner offer a promising alternative.
This work presents a self-supervised learning framework combining learning-based inertial odometry (IO) module and differentiable model predictive control (d-MPC) for Unmanned Aerial Vehicle (UAV) attitude control. The IO denoises raw IMU measurements and predicts UAV attitudes, which are then optimized by MPC for control actions in a bi-level optimization (BLO) setup, where the inner MPC optimizes control actions and the upper level minimizes discrepancy between real-world and predicted performance. The framework is thus end-to-end and can be trained in a self-supervised manner. This approach combines the strength of learning-based perception with the interpretable model-based control. Results show the effectiveness even under strong wind. It can simultaneously enhance both the MPC parameter learning and IMU prediction performance.</p>

<h2 id="approach-overview">Approach Overview</h2>
<figure>
 <img src="/img/posts/2025-04-11-iMPC/Pipeline.png" />
 <figcaption>
       The proposed framework
 </figcaption>
</figure>

<p>Our method integrates a perception network with a physics-based MPC optimizer to enable self-supervised learning for UAV control. The perception network processes raw IMU measurements to predict high-level MPC parameters (e.g., dynamics, objectives, constraints; UAV’s current state here), while the MPC solves for optimal state and control sequences under system dynamics constraints. We define the upper-level loss function as the discrepancy between dynamics calculated states and IMU-driven perception predicted states. Leveraging implicit differentiation via PyPose’s differentiable MPC (d-MPC), our method efficiently avoids costly unrolled gradient computations. This design enables end-to-end joint training, ensuring dynamically feasible and physically grounded learning without relying on labeled data.</p>

<h2 id="experiment-results">Experiment Results</h2>
<p>The UAV attitude quickly returns to a stable hover state for an initial condition of 20° using our iMPC as the controller.</p>
<figure>
  <img src="/img/posts/2025-04-11-iMPC/Response.png" />
  <figcaption>
    UAV performances
  </figcaption>
</figure>

<h5 id="control-performance-of-impc-and-reinforcement-learning--proximal-policy-optimization-ppo-under-different-levels-of-wind-disturbance">Control performance of iMPC and Reinforcement Learning  Proximal Policy Optimization (PPO) under different levels of wind disturbance.</h5>

<div class="columns is-centered">
       <div class="column is-6">
              <figure>
              <img src="/img/posts/2025-04-11-iMPC/wind_impulse6.png" />
              <figcaption>
                     UAV pitch angle response when encountering an <strong> impulse wind </strong> disturbance at 0.2s for different speeds. PPO loses control at a wind speed of 15 m/s, while iMPC loses control at 45 m/s.
              </figcaption>
              </figure>
       </div>
       <div class="column is-6">
              <figure>
              <img src="/img/posts/2025-04-11-iMPC/wind_step6.png" />
              <figcaption>
                     UAV pitch angle response when the encountering a <strong> step wind </strong> disturbance at 0.2s and lasting for 0.3s for different speeds. PPO loses control at a wind speed of 15 m/s, while iMPC loses control at 35 m/s.
              </figcaption>
              </figure>
       </div>
</div>

<h5 id="learned-dynamics-parameters">Learned Dynamics Parameters</h5>
<p>We also evaluate the learning performance in the d-MPC. In particular, we treat the UAV mass and moment of inertia (MOI) as the learnable parameters.</p>

<table>
  <caption>The learned UAV MOI and mass error using our method under different initial conditions with an initial value of 50% offset.</caption>
  <thead>
    <tr>
      <th rowspan="2"> </th>
      <th rowspan="2">Initial Offset</th>
    </tr>
    <tr>
      <th>Initial</th><th>Error</th>
      <th>Initial</th><th>Error</th>
      <th>Initial</th><th>Error</th>
      <th>Initial</th><th>Error</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>MOI</td>
      <td>50%</td>
      <td>0°</td><td>0.96%</td>
      <td>10°</td><td>2.67%</td>
      <td>15°</td><td>3.41%</td>
      <td>20°</td><td>2.22%</td>
    </tr>
    <tr>
      <td>Mass</td>
      <td>50%</td>
      <td>0°</td><td>1.69%</td>
      <td>10°</td><td>0.85%</td>
      <td>15°</td><td>1.43%</td>
      <td>20°</td><td>0.32%</td>
    </tr>
  </tbody>
</table>

<!-- ### Publication -->
<section class="section" id="Publication">
  <div class="container is-max-desktop content">
    <h2 class="title">BibTeX</h2>
    <pre><code>@inproceedings{He2025iMPC,
       author    = {Haonan He and Yuheng Qiu and Junyi Geng},
       title     = {Imperative MPC: An End-to-End Self-Supervised Learning with Differentiable MPC for UAV Attitude Control},
       booktitle = {Proceedings of the 7th Annual Learning for Dynamics &amp; Control Conference},
       year      = {2025},
       pages     = {Accepted}
}</code></pre>
  </div>
</section>

</div>

<div class="tags">
    
</div>


  

  <div id="disqus_thread"></div>
  <script>
    var disqus_config = function () {
      this.page.url = 'https://ari-psu.github.io/iMPC/';
      this.page.identifier = 'https://ari-psu.github.io/iMPC/';
    };
    (function() {
      var d = document, s = d.createElement('script');
      s.src = 'https://jennygeng.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>



                </div>
                
                <div class="column is-4-desktop is-12-tablet">
                    <p class="title is-4">Latest Research</p>


<div class="columns is-multiline">
    
    <div class="column is-12">
        <a href="/AirIO/">
<div class="card" style="height: 100%; display: flex; flex-direction: column; align-items: center;">
    
        <div style="height: 200px;">
            <img src="/img/posts/2025-06-17-AirIO/blackbird_github.gif" alt="AirIO: Learning Inertial Odometry with Enhanced IMU Feature Observability" style="object-fit: contain; height: 100%;">
        </div>
    
    <div class="card-content" style="flex-grow: 3;">
        <div class="content">
            
            <div class="title is-5">AirIO: Learning Inertial Odometry with Enhanced IMU Feature Observability</div>
            
            <p>AbstractInertial odometry (IO) using only Inertial Measurement Units (IMUs) offers a lightweight ...</p>
        </div>
    </div>
    <footer class="card-footer">
        <p class="card-footer-item">Published: Jun 17, 2025</p>
    </footer>
</div>
</a>

    </div>
    
    <div class="column is-12">
        <a href="/flying_hand/">
<div class="card" style="height: 100%; display: flex; flex-direction: column; align-items: center;">
    
        <div style="height: 200px;">
            <img src="/img/posts/2025-05-09-flying_hand/teaser.gif" alt="Flying Hand: End-Effector-Centric Framework for Versatile Aerial Manipulation Teleoperation and Policy Learning" style="object-fit: contain; height: 100%;">
        </div>
    
    <div class="card-content" style="flex-grow: 3;">
        <div class="content">
            
            <div class="title is-5">Flying Hand: End-Effector-Centric Framework for Versatile Aerial Manipulation Teleoperation and Policy Learning</div>
            
            <p>Aerial manipulation has recently attracted increasing interest from both industry and academia. P...</p>
        </div>
    </div>
    <footer class="card-footer">
        <p class="card-footer-item">Published: May 9, 2025</p>
    </footer>
</div>
</a>

    </div>
    
</div>




                </div>
                
            </div>
        </div>
    </section>
     <style>
  #blocks {
      width:100%;
      height:60px;
      margin:0 auto;
      /* background-color: #ffe; */
  }
  #block1 {
      height:33.33%;
      width:30%;
      /* background: red; */
      float: left;
      padding-left: 50px;
  }
  #block2 {
      height:33.33%;
      width:40%;
      /* background: yellow; */
      float: left;
  }
  #block3 {
      height:33.33%;
      width:30%;
      /* background: green; */
      float: right;
      padding-top: 30px;
  }
</style>

<footer class="footer">
    <div class="container">
        <!-- 
        <div class="columns is-multiline">
            
            <div class="column has-text-centered">
                <div>
                    <a href="/" class="link">Home</a>
                </div>
            </div>
            
            <div class="column has-text-centered">
                <div>
                    <a href="/blog/" class="link">Blog</a>
                </div>
            </div>
            
            <div class="column has-text-centered">
                <div>
                    <a href="/products/" class="link">Products</a>
                </div>
            </div>
            
            <div class="column has-text-centered">
                <div>
                    <a href="/privacy-policy/" class="link">Privacy Policy</a>
                </div>
            </div>
            
        </div>
         -->
        <div id="blocks">
          <div id="block1"><img src="/img/logos/Horizontal@2x.png" alt="ARI Lab Logo" style="width:100%; margin-top: -5%;"></div>
          <div id="block2">
            <center>
              <!-- <a class="button" itemprop="email" href="https://www.facebook.com" target="_blank">
                <i class="fab fa-github"></i>
              </a> -->
              <!-- <a class="button" itemprop="email" href="https://www.facebook.com" target="_blank">
                <i class="fab fa-facebook"</i>
              </a> -->
              <a class="button" itemprop="google scholar" href="https://scholar.google.com/citations?user=psUhJgcAAAAJ&hl=en&oi=sra" target="_blank">
                <i class="fab fa-google scholar fa-lg"></i>
              </a>
              <a class="button" itemprop="github" href="https://github.com/aerogjy" target="_blank">
                <i class="fab fa-github fa-lg"></i>
              </a>
              <a class="button" itemprop="linkedin" href="https://www.linkedin.com/in/junyi-geng-ph-d-9823a3b5/" target="_blank">
                <i class="fab fa-linkedin fa-lg"></i>
              </a>
              <br>
              <br>
              <p class="">&copy; 2021 | Built using the <a href="https://github.com/chrisrhymes/bulma-clean-theme">Bulma Clean Theme</a></p>
            </center>
          </div>
          <div id="block3"><img src="/img/logos/psuaero.png" alt="PSU Logo" style="width:100%; margin-top: -5%"></div>
        </div>
        <!-- <div>
          <a href="" class="button is-large"><div class="icon"><i class="fab fa-facebook"</i></div></a>
        </div> -->
        <!-- <div class="content is-small has-text-centered">
            <p class="">© 2020</p>
        </div> -->
    </div>


</footer>
 
    <script src="/assets/js/app.js" type="text/javascript"></script><!-- footer scripts --></body>

</html>
